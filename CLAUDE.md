# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Common Development Commands

### Development Server
```bash
npm run dev
```
Starts the Next.js development server at http://localhost:3000

### Build and Generate RSS
```bash
npm run build
```
Builds the Next.js application for production and generates the RSS feed

### RSS Generation
```bash
npm run rss
```
Manually generates the RSS feed using `scripts/generate-rss.js`

### Newsletter Publishing
```bash
npm run newsletter
```
Publishes the most recent blog post to ButtonDown newsletter

```bash
npm run newsletter:post <post-id>
```
Publishes a specific post by ID to ButtonDown newsletter (post ID is filename without .md extension)

## Architecture Overview

This is a static blog site built with Next.js and deployed on Netlify. The architecture follows a simple pattern:

### Content Management
- Blog posts are stored as Markdown files in `content/posts/`
- Each post has frontmatter with `title` and `date` fields
- Posts are processed using `gray-matter` for frontmatter parsing and `remark` for HTML conversion
- Content processing logic is centralized in `src/lib/posts.ts`

### Page Structure
- Homepage (`src/pages/index.tsx`): Lists all posts sorted by date
- Individual posts (`src/pages/posts/[id].tsx`): Dynamic route for post content
- Static generation using Next.js `getStaticProps` and `getStaticPaths`

### Styling and Layout
- Uses Tailwind CSS with typography plugin for content styling
- Shared layout component in `src/components/layout.tsx`
- Path aliases configured: `@/*` maps to `./src/*`

### External Integrations
- **ButtonDown Newsletter**: Automated publishing via `scripts/publish-to-buttondown.js`
- **RSS Feed**: Generated by `scripts/generate-rss.js` during build
- **Netlify Redirects**: Legacy URL redirects handled via `public/_redirects`

### Configuration Notes
- Next.js configured for static export (`output: 'export'`)
- Images are unoptimized for static hosting
- TypeScript with strict mode enabled
- Environment variables for ButtonDown API key stored in `.env`

### File Organization
- `src/lib/`: Core utilities (posts processing, RSS generation)
- `src/components/`: Reusable React components
- `src/pages/`: Next.js pages and API routes
- `content/posts/`: Markdown blog posts
- `scripts/`: Build and deployment scripts
- `public/`: Static assets and Netlify configuration

### URL Structure
- Blog home: `/`
- Individual posts: `/posts/[post-id]`
- Legacy redirects from old URL structure handled by Netlify